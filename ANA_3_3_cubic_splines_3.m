clear all
close all

x=0:0.001:1.0;
u=[0.302, 0.302157805, 0.302304106, 0.302438965, 0.302562442, 0.302674598, 0.302775495, 0.302865194, 0.302943756, 0.303011243, 0.303067715, 0.303113234, 0.303147861, 0.303171657, 0.303184683, 0.303187, 0.303178671, 0.303159755, 0.303130314, 0.30309041, 0.303040103, 0.302979455, 0.302908526, 0.302827379, 0.302736073, 0.302634672, 0.302523234, 0.302401823, 0.302270498, 0.302129322, 0.301978355, 0.301817659, 0.301647294, 0.301467322, 0.301277805, 0.301078802, 0.300870376, 0.300652588, 0.300425499, 0.30018917, 0.299943662, 0.299689037, 0.299425355, 0.299152678, 0.298871067, 0.298580584, 0.298281288, 0.297973243, 0.297656508, 0.297331145, 0.296997215, 0.29665478, 0.2963039, 0.295944638, 0.295577053, 0.295201207, 0.294817161, 0.294424977, 0.294024716, 0.293616438, 0.293200206, 0.29277608, 0.292344121, 0.291904392, 0.291456952, 0.291001863, 0.290539186, 0.290068983, 0.289591314, 0.289106241, 0.288613825, 0.288114127, 0.287607209, 0.287093131, 0.286571955, 0.286043742, 0.285508554, 0.28496645, 0.284417493, 0.283861744, 0.283299264, 0.282730113, 0.282154354, 0.281572048, 0.280983255, 0.280388037, 0.279786455, 0.279178571, 0.278564445, 0.277944138, 0.277317713, 0.276685229, 0.276046748, 0.275402332, 0.274752042, 0.274095938, 0.273434082, 0.272766536, 0.27209336, 0.271414615, 0.270730363, 0.270040665, 0.269345582, 0.268645176, 0.267939507, 0.267228636, 0.266512626, 0.265791536, 0.265065429, 0.264334366, 0.263598407, 0.262857613, 0.262112047, 0.261361769, 0.260606841, 0.259847323, 0.259083277, 0.258314763, 0.257541844, 0.256764581, 0.255983034, 0.255197264, 0.254407334, 0.253613304, 0.252815235, 0.252013189, 0.251207226, 0.250397408, 0.249583796, 0.248766452, 0.247945436, 0.24712081, 0.246292634, 0.245460971, 0.244625881, 0.243787425, 0.242945665, 0.242100661, 0.241252476, 0.24040117, 0.239546804, 0.23868944, 0.237829138, 0.236965961, 0.236099969, 0.235231223, 0.234359784, 0.233485714, 0.232609074, 0.231729926, 0.230848329, 0.229964346, 0.229078038, 0.228189466, 0.22729869, 0.226405773, 0.225510775, 0.224613758, 0.223714783, 0.222813911, 0.221911203, 0.22100672, 0.220100524, 0.219192676, 0.218283236, 0.217372267, 0.216459829, 0.215545984, 0.214630793, 0.213714316, 0.212796615, 0.211877752, 0.210957787, 0.210036782, 0.209114798, 0.208191896, 0.207268137, 0.206343583, 0.205418294, 0.204492332, 0.203565758, 0.202638634, 0.20171102, 0.200782977, 0.199854567, 0.198925851, 0.19799689, 0.197067746, 0.196138479, 0.195209151, 0.194279823, 0.193350556, 0.192421411, 0.19149245, 0.190563734, 0.189635323, 0.188707279, 0.187779664, 0.186852538, 0.185925963, 0.185, 0.18407471, 0.183150154, 0.182226393, 0.181303489, 0.180381503, 0.179460496, 0.178540529, 0.177621663, 0.17670396, 0.175787481, 0.174872286, 0.173958438, 0.173045997, 0.172135025, 0.171225582, 0.17031773, 0.169411531, 0.168507044, 0.167604332, 0.166703456, 0.165804477, 0.164907455, 0.164012453, 0.163119532, 0.162228752, 0.161340174, 0.160453861, 0.159569873, 0.158688271, 0.157809117, 0.156932472, 0.156058397, 0.155186952, 0.154318201, 0.153452202, 0.152589019, 0.151728711, 0.15087134, 0.150016968, 0.149165655, 0.148317463, 0.147472453, 0.146630686, 0.145792223, 0.144957126, 0.144125455, 0.143297272, 0.142472638, 0.141651614, 0.140834262, 0.140020642, 0.139210816, 0.138404845, 0.13760279, 0.136804712, 0.136010673, 0.135220734, 0.134434956, 0.1336534, 0.132876127, 0.132103198, 0.131334676, 0.13057062, 0.129811092, 0.129056154, 0.128305866, 0.127560289, 0.126819486, 0.126083516, 0.125352442, 0.124626324, 0.123905224, 0.123189202, 0.122478321, 0.121772641, 0.121072223, 0.120377128, 0.119687419, 0.119003155, 0.118324399, 0.11765121, 0.116983652, 0.116321784, 0.115665668, 0.115015365, 0.114370936, 0.113732443, 0.113099946, 0.112473507, 0.111853188, 0.111239048, 0.11063115, 0.110029555, 0.109434323, 0.108845516, 0.108263196, 0.107687423, 0.107118258, 0.106555764, 0.106, 0.105451026, 0.104908895, 0.104373654, 0.103845355, 0.103324047, 0.102809779, 0.102302601, 0.101802563, 0.101309715, 0.100824105, 0.100345785, 0.0998748026, 0.0994112085, 0.0989550521, 0.0985063831, 0.0980652513, 0.0976317061, 0.0972057974, 0.0967875748, 0.0963770878, 0.0959743863, 0.0955795198, 0.0951925381, 0.0948134907, 0.0944424274, 0.0940793977, 0.0937244515, 0.0933776382, 0.0930390077, 0.0927086095, 0.0923864933, 0.0920727088, 0.0917673057, 0.0914703335, 0.091181842, 0.0909018809, 0.0906304997, 0.0903677482, 0.090113676, 0.0898683328, 0.0896317682, 0.0894040319, 0.0891851736, 0.0889752429, 0.0887742895, 0.0885823631, 0.0883995133, 0.0882257897, 0.0880612421, 0.0879059201, 0.0877598733, 0.0876231515, 0.0874958043, 0.0873778813, 0.0872694322, 0.0871705067, 0.0870811545, 0.0870014251, 0.0869313683, 0.0868710338, 0.0868204711, 0.08677973, 0.0867488601, 0.086727911, 0.0867169325, 0.0867159742, 0.0867250858, 0.0867443169, 0.0867737171, 0.0868133363, 0.0868632239, 0.0869234297, 0.0869940033, 0.0870749945, 0.0871664528, 0.0872684279, 0.0873809695, 0.0875041273, 0.0876379508, 0.0877824899, 0.087937794, 0.088103913, 0.0882808964, 0.088468794, 0.0886676553, 0.0888775301, 0.089098468, 0.0893305187, 0.0895737318, 0.089828157, 0.0900938439, 0.0903708423, 0.0906592018, 0.090958972, 0.0912702026, 0.0915929433, 0.0919272437, 0.0922731535, 0.0926307224, 0.093, 0.0933810784, 0.0937742193, 0.094179727, 0.0945979055, 0.095029059, 0.0954734917, 0.0959315077, 0.0964034112, 0.0968895064, 0.0973900974, 0.0979054884, 0.0984359836, 0.098981887, 0.0995435028, 0.100121135, 0.100715089, 0.101325667, 0.101953174, 0.102597915, 0.103260193, 0.103940312, 0.104638577, 0.105355292, 0.106090762, 0.106845289, 0.107619179, 0.108412735, 0.109226262, 0.110060064, 0.110914445, 0.111789709, 0.11268616, 0.113604103, 0.114543841, 0.11550568, 0.116489922, 0.117496872, 0.118526835, 0.119580114, 0.120657014, 0.121757838, 0.122882891, 0.124032478, 0.125206901, 0.126406466, 0.127631477, 0.128882237, 0.130159052, 0.131462224, 0.132792058, 0.134148859, 0.13553293, 0.136944576, 0.138384101, 0.139851809, 0.141348004, 0.14287299, 0.144427072, 0.146010553, 0.147623738, 0.149266931, 0.150940436, 0.152644558, 0.1543796, 0.156145866, 0.157943661, 0.15977329, 0.161635055, 0.163529261, 0.165456213, 0.167416214, 0.169409569, 0.171436582, 0.173497557, 0.175592798, 0.17772261, 0.179887296, 0.18208716, 0.184322508, 0.186593642, 0.188900867, 0.191244488, 0.193624808, 0.196042132, 0.198496764, 0.200989008, 0.203519167, 0.206087547, 0.208694452, 0.211340184, 0.21402505, 0.216749353, 0.219513396, 0.222317485, 0.225161923, 0.228047015, 0.230973064, 0.233940375, 0.236949253, 0.24, 0.243092692, 0.246226484, 0.249400302, 0.252613071, 0.255863717, 0.259151166, 0.262474344, 0.265832176, 0.269223587, 0.272647505, 0.276102853, 0.279588559, 0.283103548, 0.286646745, 0.290217076, 0.293813466, 0.297434843, 0.30108013, 0.304748255, 0.308438142, 0.312148717, 0.315878907, 0.319627636, 0.323393831, 0.327176416, 0.330974319, 0.334786464, 0.338611777, 0.342449185, 0.346297611, 0.350155984, 0.354023227, 0.357898267, 0.361780029, 0.365667439, 0.369559424, 0.373454908, 0.377352817, 0.381252077, 0.385151613, 0.389050352, 0.392947219, 0.39684114, 0.40073104, 0.404615845, 0.408494481, 0.412365873, 0.416228948, 0.420082631, 0.423925847, 0.427757523, 0.431576584, 0.435381955, 0.439172563, 0.442947333, 0.44670519, 0.450445062, 0.454165872, 0.457866547, 0.461546014, 0.465203196, 0.46883702, 0.472446412, 0.476030298, 0.479587602, 0.483117252, 0.486618172, 0.490089288, 0.493529526, 0.496937812, 0.500313071, 0.503654229, 0.506960212, 0.510229945, 0.513462355, 0.516656366, 0.519810904, 0.522924896, 0.525997267, 0.529026943, 0.532012848, 0.53495391, 0.537849054, 0.540697205, 0.543497289, 0.546248232, 0.548948959, 0.551598397, 0.55419547, 0.556739105, 0.559228228, 0.561661763, 0.564038637, 0.566357776, 0.568618105, 0.570818549, 0.572958036, 0.575035489, 0.577049835, 0.579, 0.580885205, 0.582705853, 0.584462643, 0.586156275, 0.587787448, 0.58935686, 0.59086521, 0.592313198, 0.593701523, 0.595030884, 0.596301979, 0.597515508, 0.598672169, 0.599772663, 0.600817688, 0.601807942, 0.602744125, 0.603626937, 0.604457075, 0.60523524, 0.60596213, 0.606638443, 0.607264881, 0.60784214, 0.608370921, 0.608851922, 0.609285842, 0.609673381, 0.610015237, 0.61031211, 0.610564698, 0.610773701, 0.610939817, 0.611063747, 0.611146187, 0.611187839, 0.6111894, 0.611151571, 0.611075049, 0.610960534, 0.610808725, 0.610620321, 0.610396021, 0.610136524, 0.609842529, 0.609514735, 0.609153842, 0.608760548, 0.608335552, 0.607879553, 0.607393251, 0.606877344, 0.606332531, 0.605759512, 0.605158986, 0.604531651, 0.603878207, 0.603199352, 0.602495786, 0.601768208, 0.601017316, 0.600243811, 0.59944839, 0.598631753, 0.597794599, 0.596937627, 0.596061536, 0.595167025, 0.594254793, 0.593325539, 0.592379963, 0.591418762, 0.590442637, 0.589452286, 0.588448409, 0.587431704, 0.58640287, 0.585362607, 0.584311613, 0.583250588, 0.58218023, 0.581101239, 0.580014314, 0.578920153, 0.577819456, 0.576712922, 0.57560125, 0.574485139, 0.573365287, 0.572242395, 0.57111716, 0.569990282, 0.568862461, 0.567734395, 0.566606782, 0.565480323, 0.564355717, 0.563233661, 0.562114856, 0.561, 0.559889671, 0.558783961, 0.557682839, 0.556586276, 0.555494242, 0.554406707, 0.553323641, 0.552245015, 0.551170798, 0.550100961, 0.549035474, 0.547974306, 0.546917429, 0.545864811, 0.544816424, 0.543772238, 0.542732222, 0.541696346, 0.540664582, 0.539636899, 0.538613266, 0.537593655, 0.536578036, 0.535566378, 0.534558651, 0.533554827, 0.532554874, 0.531558764, 0.530566466, 0.52957795, 0.528593186, 0.527612146, 0.526634798, 0.525661113, 0.524691061, 0.523724612, 0.522761737, 0.521802405, 0.520846586, 0.519894252, 0.518945371, 0.517999914, 0.517057852, 0.516119153, 0.515183789, 0.51425173, 0.513322945, 0.512397406, 0.511475081, 0.510555941, 0.509639957, 0.508727098, 0.507817334, 0.506910636, 0.506006974, 0.505106318, 0.504208638, 0.503313904, 0.502422086, 0.501533155, 0.500647081, 0.499763833, 0.498883382, 0.498005699, 0.497130752, 0.496258513, 0.495388951, 0.494522037, 0.49365774, 0.492796031, 0.491936881, 0.491080258, 0.490226134, 0.489374478, 0.48852526, 0.487678452, 0.486834022, 0.485991941, 0.485152179, 0.484314706, 0.483479493, 0.482646509, 0.481815725, 0.48098711, 0.480160636, 0.479336271, 0.478513987, 0.477693753, 0.47687554, 0.476059317, 0.475245054, 0.474432723, 0.473622293, 0.472813734, 0.472007016, 0.471202109, 0.470398984, 0.469597611, 0.468797959, 0.468, 0.467203703, 0.466409037, 0.465615975, 0.464824484, 0.464034537, 0.463246102, 0.46245915, 0.461673651, 0.460889576, 0.460106893, 0.459325574, 0.458545589, 0.457766908, 0.4569895, 0.456213336, 0.455438387, 0.454664622, 0.453892011, 0.453120525, 0.452350133, 0.451580807, 0.450812515, 0.450045229, 0.449278917, 0.448513551, 0.447749101, 0.446985536, 0.446222827, 0.445460944, 0.444699858, 0.443939537, 0.443179953, 0.442421075, 0.441662873, 0.440905319, 0.440148381, 0.439392031, 0.438636237, 0.437880971, 0.437126203, 0.436371902, 0.435618038, 0.434864583, 0.434111505, 0.433358776, 0.432606365, 0.431854242, 0.431102378, 0.430350743, 0.429599306, 0.428848038, 0.428096909, 0.42734589, 0.42659495, 0.42584406, 0.425093189, 0.424342307, 0.423591386, 0.422840395, 0.422089304, 0.421338083, 0.420586703, 0.419835134, 0.419083345, 0.418331307, 0.41757899, 0.416826364, 0.416073399, 0.415320066, 0.414566334, 0.413812174, 0.413057556, 0.41230245, 0.411546826, 0.410790654, 0.410033905, 0.409276548, 0.408518554, 0.407759892, 0.407000534, 0.406240448, 0.405479606, 0.404717977, 0.403955532, 0.40319224, 0.402428072, 0.401662997, 0.400896987, 0.400130011, 0.399362039, 0.398593042, 0.397822989, 0.397051851, 0.396279598, 0.3955062, 0.394731627, 0.393955849, 0.393178836, 0.392400559, 0.391620988, 0.390840093, 0.390057843, 0.38927421, 0.388489162, 0.387702672, 0.386914707, 0.386125239, 0.385334238, 0.384541674, 0.383747517, 0.382951737, 0.382154305, 0.38135519, 0.380554362, 0.379751792, 0.37894745, 0.378141306, 0.37733333, 0.376523493, 0.375711764, 0.374898113, 0.374082511, 0.373264928, 0.372445334, 0.371623698, 0.370799993, 0.369974186, 0.369146249, 0.368316152, 0.367483864, 0.366649356, 0.365812599, 0.364973561, 0.364132214, 0.363288528, 0.362442472, 0.361594016, 0.360743132, 0.359889788, 0.359033956, 0.358175605, 0.357314705, 0.356451227, 0.355585141, 0.354716417, 0.353845024, 0.352970934, 0.352094115, 0.35121454, 0.350332176, 0.349446996, 0.348558968, 0.347668063, 0.346774251, 0.345877503, 0.344977787, 0.344075075, 0.343169337, 0.342260543, 0.341348662, 0.340433666, 0.339515523, 0.338594205, 0.337669681, 0.336741922, 0.335810898, 0.334876578, 0.333938934, 0.332997935, 0.33205355, 0.331105752, 0.330154508, 0.329199791, 0.328241569, 0.327279813, 0.326314493, 0.32534558, 0.324373043, 0.323396852, 0.322416978, 0.321433391, 0.32044606, 0.319454957, 0.318460051, 0.317461312, 0.316458711, 0.315452217, 0.314441801, 0.313427432, 0.312409082, 0.31138672, 0.310360316, 0.309329841, 0.308295264, 0.307256556, 0.306213686, 0.305166626, 0.304115345, 0.303059813, 0.302];


x_fit=[0.0,0.2,0.3,0.4,0.5,0.6,0.7,0.8,1.0];		% data to be interpolated
y_fit = [0.302,0.185,0.106,0.093,0.240,0.579,0.561,0.468,0.302];


figure
plot(x_fit,y_fit,'.','MarkerSize',15)
hold on
plot(x,u,"LineWidth",0.8)
legend("given data","Cubic spline")
grid minor