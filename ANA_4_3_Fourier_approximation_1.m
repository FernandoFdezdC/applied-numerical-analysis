clear all
close all

x = [-3.14159265, -3.0787608, -3.01592895, -2.95309709, -2.89026524, -2.82743339, -2.76460154, -2.70176968, -2.63893783, -2.57610598, -2.51327412, -2.45044227, -2.38761042, -2.32477856, -2.26194671, -2.19911486, -2.136283, -2.07345115, -2.0106193, -1.94778745, -1.88495559, -1.82212374, -1.75929189, -1.69646003, -1.63362818, -1.57079633, -1.50796447, -1.44513262, -1.38230077, -1.31946891, -1.25663706, -1.19380521, -1.13097336, -1.0681415, -1.00530965, -0.942477796, -0.879645943, -0.81681409, -0.753982237, -0.691150384, -0.628318531, -0.565486678, -0.502654825, -0.439822972, -0.376991118, -0.314159265, -0.251327412, -0.188495559, -0.125663706, -0.0628318531, 0, 0.0628318531, 0.125663706, 0.188495559, 0.251327412, 0.314159265, 0.376991118, 0.439822972, 0.502654825, 0.565486678, 0.628318531, 0.691150384, 0.753982237, 0.81681409, 0.879645943, 0.942477796, 1.00530965, 1.0681415, 1.13097336, 1.19380521, 1.25663706, 1.31946891, 1.38230077, 1.44513262, 1.50796447, 1.57079633, 1.63362818, 1.69646003, 1.75929189, 1.82212374, 1.88495559, 1.94778745, 2.0106193, 2.07345115, 2.136283, 2.19911486, 2.26194671, 2.32477856, 2.38761042, 2.45044227, 2.51327412, 2.57610598, 2.63893783, 2.70176968, 2.76460154, 2.82743339, 2.89026524, 2.95309709, 3.01592895, 3.0787608, 3.14159265];
R = x;
f2 = [-4.89842542e-016, -0.250914273, -0.499356354, -0.742887182, -0.979133448, -1.20581924, -1.42079621, -1.62207183, -1.80783527, -1.97648064, -2.12662702, -2.25713523, -2.36712094, -2.45596398, -2.52331374, -2.56909051, -2.5934829, -2.59694129, -2.58016735, -2.54410008, -2.48989828, -2.41892, -2.33269905, -2.23291929, -2.12138669, -2, -1.87072022, -1.73553952, -1.59644995, -1.45541265, -1.31432778, -1.17500587, -1.03914086, -0.908285435, -0.783828799, -0.666977472, -0.558739235, -0.459910526, -0.371067483, -0.292560729, -0.224513988, -0.166826537, -0.119179423, -0.0810453404, -0.0517019994, -0.0302487365, -0.0156261002, -0.00663807649, -0.00197657996, -0.000247805494, 0, 0.000247805494, 0.00197657996, 0.00663807649, 0.0156261002, 0.0302487365, 0.0517019994, 0.0810453404, 0.119179423, 0.166826537, 0.224513988, 0.292560729, 0.371067483, 0.459910526, 0.558739235, 0.666977472, 0.783828799, 0.908285435, 1.03914086, 1.17500587, 1.31432778, 1.45541265, 1.59644995, 1.73553952, 1.87072022, 2, 2.12138669, 2.23291929, 2.33269905, 2.41892, 2.48989828, 2.54410008, 2.58016735, 2.59694129, 2.5934829, 2.56909051, 2.52331374, 2.45596398, 2.36712094, 2.25713523, 2.12662702, 1.97648064, 1.80783527, 1.62207183, 1.42079621, 1.20581924, 0.979133448, 0.742887182, 0.499356354, 0.250914273, 4.89842542e-016];
f4 = [-9.79685083e-016, -0.500180093, -0.98564956, -1.4423786, -1.85766215, -2.22069216, -2.52302761, -2.75893756, -2.92559995, -3.02314706, -3.05455732, -3.02540196, -2.94346305, -2.81824669, -2.66042058, -2.48120921, -2.29178177, -2.10266741, -1.92323046, -1.76123385, -1.62251319, -1.51077695, -1.42754022, -1.37219146, -1.34218358, -1.33333333, -1.340207, -1.35656536, -1.37583822, -1.39159753, -1.3979992, -1.39016637, -1.36449123, -1.31883861, -1.25264091, -1.16688143, -1.06397063, -0.94752647, -0.822076362, -0.692702906, -0.56465904, -0.442979717, -0.332117049, -0.235623822, -0.15590667, -0.0940651412, -0.0498268748, -0.0215823868, -0.00651611137, -0.000823738302, 0, 0.000823738302, 0.00651611137, 0.0215823868, 0.0498268748, 0.0940651412, 0.15590667, 0.235623822, 0.332117049, 0.442979717, 0.56465904, 0.692702906, 0.822076362, 0.94752647, 1.06397063, 1.16688143, 1.25264091, 1.31883861, 1.36449123, 1.39016637, 1.3979992, 1.39159753, 1.37583822, 1.35656536, 1.340207, 1.33333333, 1.34218358, 1.37219146, 1.42754022, 1.51077695, 1.62251319, 1.76123385, 1.92323046, 2.10266741, 2.29178177, 2.48120921, 2.66042058, 2.81824669, 2.94346305, 3.02540196, 3.05455732, 3.02314706, 2.92559995, 2.75893756, 2.52302761, 2.22069216, 1.85766215, 1.4423786, 0.98564956, 0.500180093, 9.79685083e-016];
f8 = [-1.95937017e-015, -0.988584719, -1.88017465, -2.59383914, -3.07762059, -3.31580503, -3.32926518, -3.16903792, -2.90468504, -2.61000867, -2.34913434, -2.1657544, -2.07751085, -2.07628991, -2.13388261, -2.21133549, -2.26961924, -2.2791171, -2.22588255, -2.11350483, -1.96052436, -1.79439008, -1.6437024, -1.53077751, -1.46635394, -1.44761905, -1.45983783, -1.48095063, -1.48779573, -1.46227303, -1.39586532, -1.29142847, -1.16191193, -1.02647619, -0.905128006, -0.813336286, -0.758044391, -0.736082914, -0.735327266, -0.738214183, -0.726621153, -0.686778206, -0.612903272, -0.508617349, -0.385802128, -0.261247702, -0.152020642, -0.070811531, -0.0225125031, -0.00293515946, 0, 0.00293515946, 0.0225125031, 0.070811531, 0.152020642, 0.261247702, 0.385802128, 0.508617349, 0.612903272, 0.686778206, 0.726621153, 0.738214183, 0.735327266, 0.736082914, 0.758044391, 0.813336286, 0.905128006, 1.02647619, 1.16191193, 1.29142847, 1.39586532, 1.46227303, 1.48779573, 1.48095063, 1.45983783, 1.44761905, 1.46635394, 1.53077751, 1.6437024, 1.79439008, 1.96052436, 2.11350483, 2.22588255, 2.2791171, 2.26961924, 2.21133549, 2.13388261, 2.07628991, 2.07751085, 2.1657544, 2.34913434, 2.61000867, 2.90468504, 3.16903792, 3.32926518, 3.31580503, 3.07762059, 2.59383914, 1.88017465, 0.988584719, 1.95937017e-015];
f16 = [-4.4918121e-015, -1.89083311, -3.15017434, -3.51602384, -3.20766664, -2.71778159, -2.45801801, -2.5221588, -2.71592213, -2.7859866, -2.64070742, -2.39362365, -2.22772432, -2.22400976, -2.30559594, -2.32874836, -2.22116295, -2.03899113, -1.90109906, -1.8732716, -1.91265039, -1.91741959, -1.82665691, -1.67396487, -1.54883082, -1.50853591, -1.52631831, -1.52194423, -1.44085479, -1.30451631, -1.18602924, -1.13794433, -1.14305467, -1.13386312, -1.05925103, -0.93288304, -0.817800214, -0.764171933, -0.761370387, -0.749921246, -0.680183056, -0.560104051, -0.446302892, -0.388276187, -0.380507161, -0.368647241, -0.302981596, -0.186758662, -0.0725537495, -0.0106584578, 0, 0.0106584578, 0.0725537495, 0.186758662, 0.302981596, 0.368647241, 0.380507161, 0.388276187, 0.446302892, 0.560104051, 0.680183056, 0.749921246, 0.761370387, 0.764171933, 0.817800214, 0.93288304, 1.05925103, 1.13386312, 1.14305467, 1.13794433, 1.18602924, 1.30451631, 1.44085479, 1.52194423, 1.52631831, 1.50853591, 1.54883082, 1.67396487, 1.82665691, 1.91741959, 1.91265039, 1.8732716, 1.90109906, 2.03899113, 2.22116295, 2.32874836, 2.30559594, 2.22400976, 2.22772432, 2.39362365, 2.64070742, 2.7859866, 2.71592213, 2.5221588, 2.45801801, 2.71778159, 3.20766664, 3.51602384, 3.15017434, 1.89083311, 4.4918121e-015];



figure
plot(x,R,x,f2,x,f4,x,f8,x,f16)
legend("real function","approximation m=2","approximation m=4","approximation m=8","approximation m=16")
axis ([-pi pi -1.5*pi 1.5*pi])
grid minor

figure
plot(x,abs(f2-R),x,abs(f4-R),x,abs(f8-R),x,abs(f16-R),"LineWidth",0.8)
legend("error m=2","error m=4","error m=8","error m=16")
axis ([-pi pi 0 3.2])
grid minor