clear all
close all

x=-2:0.01:2;
u=[0.0001557636, -4.99434497e-005, -0.000255515275, -0.000460816652, -0.000665712357, -0.000870067166, -0.00107374585, -0.0012766132, -0.00147853397, -0.00167937295, -0.00187899492, -0.00207726464, -0.0022740469, -0.00246920647, -0.00266260812, -0.00285411664, -0.00304359679, -0.00323091336, -0.00341593112, -0.00359851485, -0.00377852931, -0.0039558393, -0.00413030958, -0.00430180493, -0.00447019012, -0.00463532993, -0.00479708914, -0.00495533253, -0.00510992486, -0.00526073092, -0.00540761548, -0.00555044331, -0.0056890792, -0.00582338791, -0.00595323423, -0.00607848293, -0.00619899879, -0.00631464657, -0.00642529107, -0.00653079705, -0.00663102929, -0.00672585256, -0.00681513164, -0.00689873131, -0.00697651635, -0.00704835152, -0.00711410161, -0.00717363138, -0.00722680563, -0.00727348912, -0.00731354662, -0.00734684292, -0.00737324279, -0.007392611, -0.00740481234, -0.00740971157, -0.00740717348, -0.00739706284, -0.00737924442, -0.00735358301, -0.00731994337, -0.00727819028, -0.00722818852, -0.00716980287, -0.0071028981, -0.00702733898, -0.0069429903, -0.00684971682, -0.00674738333, -0.0066358546, -0.0065149954, -0.00638467052, -0.00624474472, -0.00609508279, -0.0059355495, -0.00576600962, -0.00558632793, -0.00539636921, -0.00519599824, -0.00498507978, -0.00476347861, -0.00453105952, -0.00428768727, -0.00403322665, -0.00376754242, -0.00349049937, -0.00320196227, -0.00290179589, -0.00258986502, -0.00226603442, -0.00193016888, -0.00158213317, -0.00122179206, -0.00084901033, -0.000463652759, -6.55841214e-005, 0.000345330807, 0.000769227252, 0.00120624044, 0.00165650558, 0.00212015792, 0.00259913734, 0.00310260244, 0.0036415165, 0.00422684278, 0.00486954455, 0.00558058509, 0.00637092767, 0.00725153555, 0.00823337201, 0.00932740031, 0.0105445837, 0.0118958855, 0.013392269, 0.0150446974, 0.016864134, 0.0188615421, 0.0210478849, 0.0234341257, 0.0260312279, 0.0288501545, 0.031901869, 0.0351973346, 0.0387475145, 0.0425633721, 0.0466558706, 0.0510359733, 0.0557146434, 0.0607028442, 0.0660115391, 0.0716516912, 0.0776342638, 0.0839702202, 0.0906705237, 0.0977461375, 0.105208025, 0.113067149, 0.121334474, 0.130020962, 0.139137576, 0.148695281, 0.158705039, 0.169177813, 0.180124567, 0.191556264, 0.203483868, 0.215918341, 0.228870647, 0.242351749, 0.25637261, 0.270944194, 0.286069912, 0.301722969, 0.317869015, 0.334473704, 0.351502686, 0.368921616, 0.386696143, 0.404791921, 0.423174602, 0.441809837, 0.460663279, 0.47970058, 0.498887392, 0.518189367, 0.537572157, 0.557001415, 0.576442791, 0.595861939, 0.61522451, 0.634496157, 0.653642531, 0.672629285, 0.691422071, 0.709986541, 0.728288346, 0.74629314, 0.763966574, 0.781274299, 0.798181969, 0.814655236, 0.830659751, 0.846161166, 0.861125134, 0.875517306, 0.889303336, 0.902448874, 0.914919573, 0.926681085, 0.937699062, 0.947939156, 0.957367019, 0.965948304, 0.973648662, 0.980433746, 0.986269207, 0.991120698, 0.994953871, 0.997734377, 0.99942787, 1, 0.99942787, 0.997734377, 0.994953871, 0.991120698, 0.986269207, 0.980433746, 0.973648662, 0.965948304, 0.957367019, 0.947939156, 0.937699062, 0.926681085, 0.914919573, 0.902448874, 0.889303336, 0.875517306, 0.861125134, 0.846161166, 0.830659751, 0.814655236, 0.798181969, 0.781274299, 0.763966574, 0.74629314, 0.728288346, 0.709986541, 0.691422071, 0.672629285, 0.653642531, 0.634496157, 0.61522451, 0.595861939, 0.576442791, 0.557001415, 0.537572157, 0.518189367, 0.498887392, 0.47970058, 0.460663279, 0.441809837, 0.423174602, 0.404791921, 0.386696143, 0.368921616, 0.351502686, 0.334473704, 0.317869015, 0.301722969, 0.286069912, 0.270944194, 0.25637261, 0.242351749, 0.228870647, 0.215918341, 0.203483868, 0.191556264, 0.180124567, 0.169177813, 0.158705039, 0.148695281, 0.139137576, 0.130020962, 0.121334474, 0.113067149, 0.105208025, 0.0977461375, 0.0906705237, 0.0839702202, 0.0776342638, 0.0716516912, 0.0660115391, 0.0607028442, 0.0557146434, 0.0510359733, 0.0466558706, 0.0425633721, 0.0387475145, 0.0351973346, 0.031901869, 0.0288501545, 0.0260312279, 0.0234341257, 0.0210478849, 0.0188615421, 0.016864134, 0.0150446974, 0.013392269, 0.0118958855, 0.0105445837, 0.00932740031, 0.00823337201, 0.00725153555, 0.00637092767, 0.00558058509, 0.00486954455, 0.00422684278, 0.0036415165, 0.00310260244, 0.00259913734, 0.00212015792, 0.00165650558, 0.00120624044, 0.000769227252, 0.000345330807, -6.55841214e-005, -0.000463652759, -0.00084901033, -0.00122179206, -0.00158213317, -0.00193016888, -0.00226603442, -0.00258986502, -0.00290179589, -0.00320196227, -0.00349049937, -0.00376754242, -0.00403322665, -0.00428768727, -0.00453105952, -0.00476347861, -0.00498507978, -0.00519599824, -0.00539636921, -0.00558632793, -0.00576600962, -0.0059355495, -0.00609508279, -0.00624474472, -0.00638467052, -0.0065149954, -0.0066358546, -0.00674738333, -0.00684971682, -0.0069429903, -0.00702733898, -0.0071028981, -0.00716980287, -0.00722818852, -0.00727819028, -0.00731994337, -0.00735358301, -0.00737924442, -0.00739706284, -0.00740717348, -0.00740971157, -0.00740481234, -0.007392611, -0.00737324279, -0.00734684292, -0.00731354662, -0.00727348912, -0.00722680563, -0.00717363138, -0.00711410161, -0.00704835152, -0.00697651635, -0.00689873131, -0.00681513164, -0.00672585256, -0.00663102929, -0.00653079705, -0.00642529107, -0.00631464657, -0.00619899879, -0.00607848293, -0.00595323423, -0.00582338791, -0.0056890792, -0.00555044331, -0.00540761548, -0.00526073092, -0.00510992486, -0.00495533253, -0.00479708914, -0.00463532993, -0.00447019012, -0.00430180493, -0.00413030958, -0.0039558393, -0.00377852931, -0.00359851485, -0.00341593112, -0.00323091336, -0.00304359679, -0.00285411664, -0.00266260812, -0.00246920647, -0.0022740469, -0.00207726464, -0.00187899492, -0.00167937295, -0.00147853397, -0.0012766132, -0.00107374585, -0.000870067166, -0.000665712357, -0.000460816652, -0.000255515275, -4.99434497e-005, 0.0001557636];


x_fit=[-2.0,-1.0,-0.5,0.0,0.5,1.0,2.0];		% data to be interpolated
y_fit = cos(x_fit).^10;


figure
plot(x_fit,y_fit,'.','MarkerSize',15)
hold on
plot(x,u,"LineWidth",0.8)
legend("given data","Cubic spline")
grid minor