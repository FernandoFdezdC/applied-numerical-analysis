clear all
close all

x = [-3.14159265, -3.11017673, -3.0787608, -3.04734487, -3.01592895, -2.98451302, -2.95309709, -2.92168117, -2.89026524, -2.85884931, -2.82743339, -2.79601746, -2.76460154, -2.73318561, -2.70176968, -2.67035376, -2.63893783, -2.6075219, -2.57610598, -2.54469005, -2.51327412, -2.4818582, -2.45044227, -2.41902634, -2.38761042, -2.35619449, -2.32477856, -2.29336264, -2.26194671, -2.23053078, -2.19911486, -2.16769893, -2.136283, -2.10486708, -2.07345115, -2.04203522, -2.0106193, -1.97920337, -1.94778745, -1.91637152, -1.88495559, -1.85353967, -1.82212374, -1.79070781, -1.75929189, -1.72787596, -1.69646003, -1.66504411, -1.63362818, -1.60221225, -1.57079633, -1.5393804, -1.50796447, -1.47654855, -1.44513262, -1.41371669, -1.38230077, -1.35088484, -1.31946891, -1.28805299, -1.25663706, -1.22522113, -1.19380521, -1.16238928, -1.13097336, -1.09955743, -1.0681415, -1.03672558, -1.00530965, -0.973893723, -0.942477796, -0.91106187, -0.879645943, -0.848230016, -0.81681409, -0.785398163, -0.753982237, -0.72256631, -0.691150384, -0.659734457, -0.628318531, -0.596902604, -0.565486678, -0.534070751, -0.502654825, -0.471238898, -0.439822972, -0.408407045, -0.376991118, -0.345575192, -0.314159265, -0.282743339, -0.251327412, -0.219911486, -0.188495559, -0.157079633, -0.125663706, -0.0942477796, -0.0628318531, -0.0314159265, 0, 0.0314159265, 0.0628318531, 0.0942477796, 0.125663706, 0.157079633, 0.188495559, 0.219911486, 0.251327412, 0.282743339, 0.314159265, 0.345575192, 0.376991118, 0.408407045, 0.439822972, 0.471238898, 0.502654825, 0.534070751, 0.565486678, 0.596902604, 0.628318531, 0.659734457, 0.691150384, 0.72256631, 0.753982237, 0.785398163, 0.81681409, 0.848230016, 0.879645943, 0.91106187, 0.942477796, 0.973893723, 1.00530965, 1.03672558, 1.0681415, 1.09955743, 1.13097336, 1.16238928, 1.19380521, 1.22522113, 1.25663706, 1.28805299, 1.31946891, 1.35088484, 1.38230077, 1.41371669, 1.44513262, 1.47654855, 1.50796447, 1.5393804, 1.57079633, 1.60221225, 1.63362818, 1.66504411, 1.69646003, 1.72787596, 1.75929189, 1.79070781, 1.82212374, 1.85353967, 1.88495559, 1.91637152, 1.94778745, 1.97920337, 2.0106193, 2.04203522, 2.07345115, 2.10486708, 2.136283, 2.16769893, 2.19911486, 2.23053078, 2.26194671, 2.29336264, 2.32477856, 2.35619449, 2.38761042, 2.41902634, 2.45044227, 2.4818582, 2.51327412, 2.54469005, 2.57610598, 2.6075219, 2.63893783, 2.67035376, 2.70176968, 2.73318561, 2.76460154, 2.79601746, 2.82743339, 2.85884931, 2.89026524, 2.92168117, 2.95309709, 2.98451302, 3.01592895, 3.04734487, 3.0787608, 3.11017673, 3.14159265];
R = abs(x);
f2 = [2.98550693, 2.98425081, 2.98048864, 2.97423896, 2.96553246, 2.95441182, 2.94093127, 2.92515621, 2.90716267, 2.88703671, 2.8648737, 2.84077756, 2.81485996, 2.78723942, 2.75804033, 2.72739202, 2.69542769, 2.6622834, 2.628097, 2.59300706, 2.55715179, 2.520668, 2.48369005, 2.44634887, 2.40877096, 2.3710775, 2.33338345, 2.29579678, 2.25841772, 2.2213381, 2.18464078, 2.14839913, 2.11267667, 2.07752673, 2.04299226, 2.00910567, 1.97588887, 1.94335333, 1.91150022, 1.88032075, 1.84979649, 1.81989983, 1.79059452, 1.76183632, 1.73357364, 1.70574836, 1.67829659, 1.65114959, 1.62423467, 1.59747614, 1.57079633, 1.54411651, 1.51735799, 1.49044307, 1.46329607, 1.4358443, 1.40801901, 1.37975634, 1.35099813, 1.32169283, 1.29179616, 1.2612719, 1.23009243, 1.19823933, 1.16570378, 1.13248699, 1.0986004, 1.06406592, 1.02891598, 0.993193522, 0.956951874, 0.920254549, 0.883174932, 0.845795874, 0.808209207, 0.770515157, 0.732821691, 0.695243782, 0.6579026, 0.620924652, 0.584440859, 0.548585589, 0.513495649, 0.479309254, 0.446164967, 0.414200636, 0.38355232, 0.354353232, 0.326732689, 0.300815096, 0.276718958, 0.254555941, 0.234429979, 0.216436446, 0.200661388, 0.187180836, 0.176060191, 0.167353698, 0.16110401, 0.157341842, 0.156085722, 0.157341842, 0.16110401, 0.167353698, 0.176060191, 0.187180836, 0.200661388, 0.216436446, 0.234429979, 0.254555941, 0.276718958, 0.300815096, 0.326732689, 0.354353232, 0.38355232, 0.414200636, 0.446164967, 0.479309254, 0.513495649, 0.548585589, 0.584440859, 0.620924652, 0.6579026, 0.695243782, 0.732821691, 0.770515157, 0.808209207, 0.845795874, 0.883174932, 0.920254549, 0.956951874, 0.993193522, 1.02891598, 1.06406592, 1.0986004, 1.13248699, 1.16570378, 1.19823933, 1.23009243, 1.2612719, 1.29179616, 1.32169283, 1.35099813, 1.37975634, 1.40801901, 1.4358443, 1.46329607, 1.49044307, 1.51735799, 1.54411651, 1.57079633, 1.59747614, 1.62423467, 1.65114959, 1.67829659, 1.70574836, 1.73357364, 1.76183632, 1.79059452, 1.81989983, 1.84979649, 1.88032075, 1.91150022, 1.94335333, 1.97588887, 2.00910567, 2.04299226, 2.07752673, 2.11267667, 2.14839913, 2.18464078, 2.2213381, 2.25841772, 2.29579678, 2.33338345, 2.3710775, 2.40877096, 2.44634887, 2.48369005, 2.520668, 2.55715179, 2.59300706, 2.628097, 2.6622834, 2.69542769, 2.72739202, 2.75804033, 2.78723942, 2.81485996, 2.84077756, 2.8648737, 2.88703671, 2.90716267, 2.92515621, 2.94093127, 2.95441182, 2.96553246, 2.97423896, 2.98048864, 2.98425081, 2.98550693];
f4 = [3.06242099, 3.05991206, 3.05243701, 3.04014931, 3.02329849, 3.00222118, 2.977329, 2.94909395, 2.91803177, 2.88468417, 2.8496004, 2.81331917, 2.77635148, 2.73916514, 2.70217147, 2.6657148, 2.63006503, 2.59541355, 2.56187249, 2.52947733, 2.49819257, 2.46792009, 2.43850986, 2.40977221, 2.38149125, 2.35343865, 2.32538721, 2.29712353, 2.2684592, 2.23924012, 2.20935349, 2.17873221, 2.14735665, 2.11525373, 2.08249344, 2.04918319, 2.01546019, 1.98148248, 1.94741901, 1.91343946, 1.87970419, 1.846355, 1.81350721, 1.78124325, 1.74960841, 1.71860867, 1.68821086, 1.65834506, 1.62890912, 1.59977495, 1.57079633, 1.54181771, 1.51268354, 1.48324759, 1.4533818, 1.42298399, 1.39198425, 1.36034941, 1.32808545, 1.29523765, 1.26188847, 1.22815319, 1.19417364, 1.16011018, 1.12613246, 1.09240947, 1.05909922, 1.02633893, 0.994236004, 0.962860446, 0.932239164, 0.90235253, 0.873133453, 0.844469123, 0.816205441, 0.788154007, 0.760101408, 0.731820442, 0.703082791, 0.673672562, 0.643400087, 0.61211532, 0.57972016, 0.546179102, 0.511527623, 0.475877857, 0.439421184, 0.402427511, 0.365241169, 0.328273484, 0.291992252, 0.25690848, 0.223560879, 0.192498707, 0.164263653, 0.139371476, 0.118294162, 0.101443341, 0.0891556388, 0.0816805978, 0.0791716592, 0.0816805978, 0.0891556388, 0.101443341, 0.118294162, 0.139371476, 0.164263653, 0.192498707, 0.223560879, 0.25690848, 0.291992252, 0.328273484, 0.365241169, 0.402427511, 0.439421184, 0.475877857, 0.511527623, 0.546179102, 0.57972016, 0.61211532, 0.643400087, 0.673672562, 0.703082791, 0.731820442, 0.760101408, 0.788154007, 0.816205441, 0.844469123, 0.873133453, 0.90235253, 0.932239164, 0.962860446, 0.994236004, 1.02633893, 1.05909922, 1.09240947, 1.12613246, 1.16011018, 1.19417364, 1.22815319, 1.26188847, 1.29523765, 1.32808545, 1.36034941, 1.39198425, 1.42298399, 1.4533818, 1.48324759, 1.51268354, 1.54181771, 1.57079633, 1.59977495, 1.62890912, 1.65834506, 1.68821086, 1.71860867, 1.74960841, 1.78124325, 1.81350721, 1.846355, 1.87970419, 1.91343946, 1.94741901, 1.98148248, 2.01546019, 2.04918319, 2.08249344, 2.11525373, 2.14735665, 2.17873221, 2.20935349, 2.23924012, 2.2684592, 2.29712353, 2.32538721, 2.35343865, 2.38149125, 2.40977221, 2.43850986, 2.46792009, 2.49819257, 2.52947733, 2.56187249, 2.59541355, 2.63006503, 2.6657148, 2.70217147, 2.73916514, 2.77635148, 2.81331917, 2.8496004, 2.88468417, 2.91803177, 2.94909395, 2.977329, 3.00222118, 3.02329849, 3.04014931, 3.05243701, 3.05991206, 3.06242099];
f8 = [3.10185545, 3.09686386, 3.08230038, 3.05933821, 3.02974133, 2.99561232, 2.95910267, 2.92213404, 2.88617574, 2.85211198, 2.82021476, 2.79021898, 2.76147783, 2.73316358, 2.70447292, 2.67479831, 2.6438362, 2.6116178, 2.57846425, 2.54488339, 2.51143554, 2.47860004, 2.44667161, 2.4157069, 2.38552937, 2.35578712, 2.32604717, 2.29590241, 2.26506605, 2.2334328, 2.20109426, 2.1683075, 2.13542617, 2.10281197, 2.07074784, 2.03937321, 2.00865562, 1.97840412, 1.94832008, 1.91807216, 1.88737704, 1.85606684, 1.8241272, 1.79169784, 1.75903606, 1.72645246, 1.6942348, 1.66257817, 1.63153832, 1.60101903, 1.57079633, 1.54057362, 1.51005433, 1.47901448, 1.44735785, 1.41514019, 1.3825566, 1.34989482, 1.31746546, 1.28552581, 1.25421561, 1.2235205, 1.19327257, 1.16318854, 1.13293704, 1.10221944, 1.07084481, 1.03878068, 1.00616648, 0.973285156, 0.940498394, 0.908159857, 0.876526606, 0.845690249, 0.81554548, 0.785805531, 0.756063282, 0.72588575, 0.694921045, 0.662992613, 0.630157113, 0.596709261, 0.563128402, 0.529974851, 0.497756449, 0.466794346, 0.437119734, 0.408429076, 0.380114824, 0.351373674, 0.321377894, 0.289480672, 0.255416909, 0.219458615, 0.182489984, 0.145980338, 0.111851328, 0.0822544387, 0.0592922725, 0.0447287906, 0.0397372074, 0.0447287906, 0.0592922725, 0.0822544387, 0.111851328, 0.145980338, 0.182489984, 0.219458615, 0.255416909, 0.289480672, 0.321377894, 0.351373674, 0.380114824, 0.408429076, 0.437119734, 0.466794346, 0.497756449, 0.529974851, 0.563128402, 0.596709261, 0.630157113, 0.662992613, 0.694921045, 0.72588575, 0.756063282, 0.785805531, 0.81554548, 0.845690249, 0.876526606, 0.908159857, 0.940498394, 0.973285156, 1.00616648, 1.03878068, 1.07084481, 1.10221944, 1.13293704, 1.16318854, 1.19327257, 1.2235205, 1.25421561, 1.28552581, 1.31746546, 1.34989482, 1.3825566, 1.41514019, 1.44735785, 1.47901448, 1.51005433, 1.54057362, 1.57079633, 1.60101903, 1.63153832, 1.66257817, 1.6942348, 1.72645246, 1.75903606, 1.79169784, 1.8241272, 1.85606684, 1.88737704, 1.91807216, 1.94832008, 1.97840412, 2.00865562, 2.03937321, 2.07074784, 2.10281197, 2.13542617, 2.1683075, 2.20109426, 2.2334328, 2.26506605, 2.29590241, 2.32604717, 2.35578712, 2.38552937, 2.4157069, 2.44667161, 2.47860004, 2.51143554, 2.54488339, 2.57846425, 2.6116178, 2.6438362, 2.67479831, 2.70447292, 2.73316358, 2.76147783, 2.79021898, 2.82021476, 2.85211198, 2.88617574, 2.92213404, 2.95910267, 2.99561232, 3.02974133, 3.05933821, 3.08230038, 3.09686386, 3.10185545];
f16 = [3.12170475, 3.11192799, 3.08565773, 3.05036345, 3.01392691, 2.98094411, 2.95153009, 2.92296986, 2.89263966, 2.86001548, 2.82659277, 2.79424445, 2.76360022, 2.73373067, 2.70317623, 2.67126893, 2.63860309, 2.60636765, 2.57524454, 2.54486572, 2.51423929, 2.48268093, 2.45039263, 2.41821202, 2.38681904, 2.35614067, 2.32546667, 2.29412619, 2.26208783, 2.22995229, 2.1983777, 2.16748256, 2.13676344, 2.10557803, 2.07373348, 2.04164465, 2.00993517, 1.97886246, 1.94809401, 1.91702765, 1.8853491, 1.85331296, 1.82149722, 1.7902667, 1.75944156, 1.72847087, 1.69694454, 1.6649697, 1.63306722, 1.60168796, 1.57079633, 1.5399047, 1.50852543, 1.47662296, 1.44464811, 1.41312179, 1.3821511, 1.35132596, 1.32009543, 1.28827969, 1.25624356, 1.224565, 1.19349864, 1.1627302, 1.13165749, 1.099948, 1.06785917, 1.03601463, 1.00482921, 0.974110093, 0.94321495, 0.911640366, 0.879504822, 0.847466468, 0.816125984, 0.785451986, 0.754773614, 0.72338063, 0.691200024, 0.658911723, 0.627353361, 0.596726935, 0.566348118, 0.535225008, 0.502989564, 0.470323722, 0.438416423, 0.407861979, 0.377992437, 0.347348207, 0.314999888, 0.281577174, 0.248952993, 0.218622791, 0.19006256, 0.160648542, 0.127665748, 0.0912292043, 0.055934925, 0.0296646604, 0.0198879007, 0.0296646604, 0.055934925, 0.0912292043, 0.127665748, 0.160648542, 0.19006256, 0.218622791, 0.248952993, 0.281577174, 0.314999888, 0.347348207, 0.377992437, 0.407861979, 0.438416423, 0.470323722, 0.502989564, 0.535225008, 0.566348118, 0.596726935, 0.627353361, 0.658911723, 0.691200024, 0.72338063, 0.754773614, 0.785451986, 0.816125984, 0.847466468, 0.879504822, 0.911640366, 0.94321495, 0.974110093, 1.00482921, 1.03601463, 1.06785917, 1.099948, 1.13165749, 1.1627302, 1.19349864, 1.224565, 1.25624356, 1.28827969, 1.32009543, 1.35132596, 1.3821511, 1.41312179, 1.44464811, 1.47662296, 1.50852543, 1.5399047, 1.57079633, 1.60168796, 1.63306722, 1.6649697, 1.69694454, 1.72847087, 1.75944156, 1.7902667, 1.82149722, 1.85331296, 1.8853491, 1.91702765, 1.94809401, 1.97886246, 2.00993517, 2.04164465, 2.07373348, 2.10557803, 2.13676344, 2.16748256, 2.1983777, 2.22995229, 2.26208783, 2.29412619, 2.32546667, 2.35614067, 2.38681904, 2.41821202, 2.45039263, 2.48268093, 2.51423929, 2.54486572, 2.57524454, 2.60636765, 2.63860309, 2.67126893, 2.70317623, 2.73373067, 2.76360022, 2.79424445, 2.82659277, 2.86001548, 2.89263966, 2.92296986, 2.95153009, 2.98094411, 3.01392691, 3.05036345, 3.08565773, 3.11192799, 3.12170475];
f32=[3.13164628, 3.11362402, 3.0777651, 3.04656081, 3.01710697, 2.98410202, 2.95260136, 2.92236678, 2.89010783, 2.85843229, 2.82789054, 2.7959992, 2.76423103, 2.73349841, 2.70183879, 2.67002379, 2.63914426, 2.6076486, 2.57581684, 2.5448117, 2.51343814, 2.48161178, 2.45049387, 2.41921224, 2.38740866, 2.35618766, 2.32497375, 2.2932069, 2.2618916, 2.23072458, 2.19900562, 2.16760504, 2.13646625, 2.10480378, 2.07332767, 2.04220009, 2.01060029, 1.9790593, 1.94792735, 1.91639404, 1.88479979, 1.8536493, 1.82218396, 1.79054892, 1.75936723, 1.72796901, 1.69630638, 1.66508246, 1.63374828, 1.60207172, 1.57079633, 1.53952093, 1.50784437, 1.4765102, 1.44528627, 1.41362364, 1.38222543, 1.35104373, 1.3194087, 1.28794336, 1.25679286, 1.22519861, 1.19366531, 1.16253335, 1.13099236, 1.09939257, 1.06826499, 1.03678887, 1.0051264, 0.973987611, 0.942587035, 0.910868072, 0.87970105, 0.84838575, 0.816618907, 0.785404996, 0.754183989, 0.722380413, 0.69109878, 0.659980871, 0.628154516, 0.596780951, 0.565775813, 0.533944054, 0.502448394, 0.471568865, 0.439753861, 0.408094244, 0.377361619, 0.345593455, 0.313702117, 0.283160363, 0.251484825, 0.219225878, 0.188991292, 0.157490636, 0.124485686, 0.0950318387, 0.0638275565, 0.0279686332, 0.00994637472, 0.0279686332, 0.0638275565, 0.0950318387, 0.124485686, 0.157490636, 0.188991292, 0.219225878, 0.251484825, 0.283160363, 0.313702117, 0.345593455, 0.377361619, 0.408094244, 0.439753861, 0.471568865, 0.502448394, 0.533944054, 0.565775813, 0.596780951, 0.628154516, 0.659980871, 0.69109878, 0.722380413, 0.754183989, 0.785404996, 0.816618907, 0.84838575, 0.87970105, 0.910868072, 0.942587035, 0.973987611, 1.0051264, 1.03678887, 1.06826499, 1.09939257, 1.13099236, 1.16253335, 1.19366531, 1.22519861, 1.25679286, 1.28794336, 1.3194087, 1.35104373, 1.38222543, 1.41362364, 1.44528627, 1.4765102, 1.50784437, 1.53952093, 1.57079633, 1.60207172, 1.63374828, 1.66508246, 1.69630638, 1.72796901, 1.75936723, 1.79054892, 1.82218396, 1.8536493, 1.88479979, 1.91639404, 1.94792735, 1.9790593, 2.01060029, 2.04220009, 2.07332767, 2.10480378, 2.13646625, 2.16760504, 2.19900562, 2.23072458, 2.2618916, 2.2932069, 2.32497375, 2.35618766, 2.38740866, 2.41921224, 2.45049387, 2.48161178, 2.51343814, 2.5448117, 2.57581684, 2.6076486, 2.63914426, 2.67002379, 2.70183879, 2.73349841, 2.76423103, 2.7959992, 2.82789054, 2.85843229, 2.89010783, 2.92236678, 2.95260136, 2.98410202, 3.01710697, 3.04656081, 3.0777651, 3.11362402, 3.13164628];



figure
plot(x,R,x,f2,x,f4,x,f8,x,f16,x,f32)
legend("real function","approximation m=2","approximation m=4","approximation m=8","approximation m=16","approximation m=32")
axis ([-pi pi 0 1.2*pi])
grid minor

figure
plot(x,abs(f2-R),x,abs(f4-R),x,abs(f8-R),x,abs(f16-R),x,abs(f32-R))
legend("error m=2","error m=4","error m=8","error m=16","error m=32")
axis ([-pi pi 0 0.2])
grid minor