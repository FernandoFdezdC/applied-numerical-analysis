clear all
close all

x=0:0.001:1;
u=[0.302, 0.301527083, 0.301054149, 0.300581181, 0.300108163, 0.299635078, 0.299161908, 0.298688638, 0.29821525, 0.297741728, 0.297268054, 0.296794212, 0.296320185, 0.295845957, 0.295371509, 0.294896827, 0.294421892, 0.293946688, 0.293471199, 0.292995407, 0.292519295, 0.292042847, 0.291566046, 0.291088875, 0.290611318, 0.290133357, 0.289654975, 0.289176157, 0.288696884, 0.288217141, 0.28773691, 0.287256175, 0.286774919, 0.286293125, 0.285810775, 0.285327855, 0.284844345, 0.284360231, 0.283875494, 0.283390119, 0.282904087, 0.282417384, 0.281929991, 0.281441891, 0.280953069, 0.280463507, 0.279973189, 0.279482097, 0.278990215, 0.278497526, 0.278004013, 0.277509659, 0.277014448, 0.276518363, 0.276021387, 0.275523502, 0.275024693, 0.274524943, 0.274024234, 0.27352255, 0.273019874, 0.27251619, 0.272011479, 0.271505727, 0.270998915, 0.270491027, 0.269982046, 0.269471956, 0.268960739, 0.268448379, 0.267934859, 0.267420161, 0.266904271, 0.266387169, 0.265868841, 0.265349268, 0.264828434, 0.264306322, 0.263782916, 0.263258199, 0.262732153, 0.262204762, 0.26167601, 0.261145878, 0.260614351, 0.260081412, 0.259547044, 0.25901123, 0.258473954, 0.257935197, 0.257394945, 0.256853179, 0.256309883, 0.255765041, 0.255218634, 0.254670648, 0.254121064, 0.253569866, 0.253017038, 0.252462561, 0.251906421, 0.251348599, 0.250789079, 0.250227843, 0.249664877, 0.249100161, 0.248533681, 0.247965418, 0.247395356, 0.246823479, 0.246249768, 0.245674209, 0.245096783, 0.244517474, 0.243936265, 0.24335314, 0.242768081, 0.242181072, 0.241592096, 0.241001136, 0.240408175, 0.239813196, 0.239216184, 0.23861712, 0.238015988, 0.237412771, 0.236807453, 0.236200016, 0.235590444, 0.23497872, 0.234364827, 0.233748749, 0.233130468, 0.232509967, 0.231887231, 0.231262241, 0.230634982, 0.230005437, 0.229373588, 0.228739419, 0.228102913, 0.227464053, 0.226822822, 0.226179204, 0.225533182, 0.224884739, 0.224233857, 0.223580522, 0.222924714, 0.222266419, 0.221605618, 0.220942296, 0.220276434, 0.219608017, 0.218937028, 0.218263449, 0.217587265, 0.216908458, 0.216227011, 0.215542908, 0.214856131, 0.214166665, 0.213474491, 0.212779594, 0.212081956, 0.211381561, 0.210678392, 0.209972432, 0.209263665, 0.208552072, 0.207837639, 0.207120347, 0.20640018, 0.205677121, 0.204951154, 0.204222261, 0.203490426, 0.202755632, 0.202017862, 0.2012771, 0.200533328, 0.199786529, 0.199036688, 0.198283787, 0.197527808, 0.196768737, 0.196006554, 0.195241245, 0.194472792, 0.193701178, 0.192926386, 0.1921484, 0.191367202, 0.190582777, 0.189795106, 0.189004174, 0.188209964, 0.187412458, 0.18661164, 0.185807493, 0.185, 0.184189166, 0.183375082, 0.18255786, 0.181737613, 0.180914453, 0.180088492, 0.179259843, 0.178428618, 0.177594929, 0.176758889, 0.175920611, 0.175080206, 0.174237787, 0.173393466, 0.172547356, 0.17169957, 0.170850218, 0.169999415, 0.169147272, 0.168293902, 0.167439416, 0.166583928, 0.16572755, 0.164870394, 0.164012573, 0.163154198, 0.162295383, 0.161436239, 0.16057688, 0.159717417, 0.158857962, 0.157998629, 0.15713953, 0.156280777, 0.155422481, 0.154564757, 0.153707716, 0.15285147, 0.151996132, 0.151141814, 0.150288629, 0.149436689, 0.148586106, 0.147736993, 0.146889463, 0.146043626, 0.145199597, 0.144357487, 0.143517408, 0.142679474, 0.141843796, 0.141010487, 0.140179659, 0.139351425, 0.138525896, 0.137703186, 0.136883406, 0.13606667, 0.135253089, 0.134442776, 0.133635843, 0.132832403, 0.132032568, 0.13123645, 0.130444161, 0.129655815, 0.128871524, 0.128091399, 0.127315554, 0.1265441, 0.12577715, 0.125014817, 0.124257212, 0.123504448, 0.122756639, 0.122013895, 0.121276329, 0.120544054, 0.119817182, 0.119095825, 0.118380096, 0.117670108, 0.116965972, 0.116267801, 0.115575707, 0.114889803, 0.114210201, 0.113537014, 0.112870353, 0.112210332, 0.111557062, 0.110910657, 0.110271227, 0.109638887, 0.109013747, 0.108395921, 0.107785521, 0.107182659, 0.106587448, 0.106, 0.105420415, 0.10484874, 0.104285013, 0.103729269, 0.103181544, 0.102641873, 0.102110293, 0.10158684, 0.101071548, 0.100564455, 0.100065596, 0.099575006, 0.0990927222, 0.0986187799, 0.0981532149, 0.0976960632, 0.0972473606, 0.096807143, 0.0963754461, 0.0959523059, 0.0955377582, 0.0951318389, 0.0947345838, 0.0943460288, 0.0939662097, 0.0935951625, 0.0932329228, 0.0928795267, 0.0925350099, 0.0921994083, 0.0918727578, 0.0915550942, 0.0912464534, 0.0909468712, 0.0906563835, 0.0903750262, 0.090102835, 0.0898398459, 0.0895860947, 0.0893416173, 0.0891064495, 0.0888806271, 0.0886641861, 0.0884571623, 0.0882595915, 0.0880715096, 0.0878929524, 0.0877239559, 0.0875645558, 0.087414788, 0.0872746884, 0.0871442928, 0.0870236371, 0.0869127572, 0.0868116888, 0.0867204679, 0.0866391302, 0.0865677118, 0.0865062483, 0.0864547757, 0.0864133298, 0.0863819465, 0.0863606617, 0.0863495111, 0.0863485307, 0.0863577562, 0.0863772236, 0.0864069688, 0.0864470275, 0.0864974356, 0.0865582289, 0.0866294434, 0.0867111149, 0.0868032793, 0.0869059723, 0.0870192299, 0.0871430878, 0.0872775821, 0.0874227484, 0.0875786228, 0.0877452409, 0.0879226387, 0.0881108521, 0.0883099169, 0.0885198689, 0.088740744, 0.088972578, 0.0892154069, 0.0894692664, 0.0897341925, 0.0900102209, 0.0902973876, 0.0905957284, 0.0909052791, 0.0912260756, 0.0915581537, 0.0919015494, 0.0922562984, 0.0926224367, 0.093, 0.0933890696, 0.0937899084, 0.0942028245, 0.0946281261, 0.0950661215, 0.0955171188, 0.0959814262, 0.0964593519, 0.0969512042, 0.0974572911, 0.0979779211, 0.0985134021, 0.0990640424, 0.0996301503, 0.100212034, 0.100810001, 0.101424361, 0.102055421, 0.102703489, 0.103368875, 0.104051885, 0.104752828, 0.105472013, 0.106209747, 0.106966338, 0.107742096, 0.108537328, 0.109352342, 0.110187447, 0.11104295, 0.11191916, 0.112816386, 0.113734934, 0.114675115, 0.115637234, 0.116621602, 0.117628526, 0.118658314, 0.119711275, 0.120787717, 0.121887947, 0.123012274, 0.124161007, 0.125334453, 0.126532921, 0.127756719, 0.129006155, 0.130281538, 0.131583174, 0.132911374, 0.134266444, 0.135648694, 0.13705843, 0.138495963, 0.139961599, 0.141455647, 0.142978415, 0.144530211, 0.146111344, 0.147722121, 0.149362851, 0.151033843, 0.152735404, 0.154467842, 0.156231466, 0.158026584, 0.159853504, 0.161712534, 0.163603983, 0.165528158, 0.167485368, 0.169475922, 0.171500126, 0.17355829, 0.175650722, 0.17777773, 0.179939622, 0.182136706, 0.184369291, 0.186637684, 0.188942194, 0.191283129, 0.193660798, 0.196075508, 0.198527567, 0.201017285, 0.203544969, 0.206110926, 0.208715467, 0.211358898, 0.214041528, 0.216763665, 0.219525617, 0.222327693, 0.225170201, 0.228053448, 0.230977743, 0.233943395, 0.236950711, 0.24, 0.243091339, 0.246223882, 0.249396553, 0.252608274, 0.25585797, 0.259144564, 0.262466978, 0.265824137, 0.269214963, 0.272638381, 0.276093312, 0.279578682, 0.283093412, 0.286636427, 0.290206649, 0.293803003, 0.297424411, 0.301069797, 0.304738084, 0.308428195, 0.312139055, 0.315869585, 0.31961871, 0.323385353, 0.327168437, 0.330966885, 0.334779622, 0.338605569, 0.342443652, 0.346292792, 0.350151913, 0.354019939, 0.357895793, 0.361778399, 0.365666679, 0.369559557, 0.373455956, 0.377354801, 0.381255013, 0.385155516, 0.389055235, 0.392953091, 0.396848009, 0.400738912, 0.404624723, 0.408504365, 0.412376763, 0.416240838, 0.420095515, 0.423939717, 0.427772367, 0.431592388, 0.435398705, 0.43919024, 0.442965916, 0.446724658, 0.450465387, 0.454187029, 0.457888505, 0.46156874, 0.465226656, 0.468861178, 0.472471228, 0.476055729, 0.479613606, 0.483143781, 0.486645178, 0.49011672, 0.49355733, 0.496965933, 0.50034145, 0.503682806, 0.506988924, 0.510258727, 0.513491139, 0.516685082, 0.519839481, 0.522953258, 0.526025338, 0.529054642, 0.532040095, 0.534980621, 0.537875141, 0.54072258, 0.543521862, 0.546271908, 0.548971644, 0.551619991, 0.554215874, 0.556758216, 0.559245939, 0.561677968, 0.564053226, 0.566370637, 0.568629122, 0.570827607, 0.572965013, 0.575040266, 0.577052287, 0.579, 0.580882626, 0.582700572, 0.584454542, 0.586145241, 0.587773373, 0.589339643, 0.590844755, 0.592289413, 0.593674322, 0.595000187, 0.596267711, 0.597477599, 0.598630556, 0.599727286, 0.600768493, 0.601754882, 0.602687157, 0.603566023, 0.604392184, 0.605166344, 0.605889208, 0.60656148, 0.607183865, 0.607757067, 0.60828179, 0.608758739, 0.609188619, 0.609572133, 0.609909986, 0.610202883, 0.610451528, 0.610656625, 0.610818879, 0.610938995, 0.611017675, 0.611055626, 0.611053551, 0.611012155, 0.610932143, 0.610814218, 0.610659085, 0.610467448, 0.610240012, 0.609977482, 0.609680562, 0.609349955, 0.608986367, 0.608590502, 0.608163065, 0.607704759, 0.607216289, 0.60669836, 0.606151676, 0.605576942, 0.604974861, 0.604346139, 0.603691479, 0.603011586, 0.602307165, 0.60157892, 0.600827555, 0.600053774, 0.599258283, 0.598441786, 0.597604986, 0.596748589, 0.595873298, 0.594979819, 0.594068855, 0.593141112, 0.592197293, 0.591238102, 0.590264245, 0.589276426, 0.588275349, 0.587261718, 0.586236238, 0.585199613, 0.584152548, 0.583095748, 0.582029916, 0.580955756, 0.579873975, 0.578785275, 0.577690361, 0.576589938, 0.57548471, 0.574375381, 0.573262656, 0.57214724, 0.571029836, 0.569911149, 0.568791884, 0.567672745, 0.566554436, 0.565437661, 0.564323126, 0.563211535, 0.562103591, 0.561, 0.55990134, 0.558807688, 0.557718995, 0.556635211, 0.555556289, 0.554482178, 0.55341283, 0.552348196, 0.551288226, 0.550232873, 0.549182086, 0.548135817, 0.547094017, 0.546056637, 0.545023628, 0.543994941, 0.542970526, 0.541950335, 0.54093432, 0.53992243, 0.538914617, 0.537910832, 0.536911026, 0.535915149, 0.534923154, 0.53393499, 0.53295061, 0.531969963, 0.530993001, 0.530019675, 0.529049936, 0.528083735, 0.527121023, 0.526161751, 0.52520587, 0.524253331, 0.523304084, 0.522358082, 0.521415275, 0.520475613, 0.519539049, 0.518605532, 0.517675015, 0.516747447, 0.515822781, 0.514900966, 0.513981954, 0.513065697, 0.512152144, 0.511241247, 0.510332958, 0.509427226, 0.508524003, 0.507623241, 0.506724889, 0.5058289, 0.504935223, 0.504043811, 0.503154613, 0.502267582, 0.501382667, 0.500499821, 0.499618994, 0.498740136, 0.4978632, 0.496988136, 0.496114895, 0.495243428, 0.494373686, 0.49350562, 0.492639181, 0.491774321, 0.490910989, 0.490049138, 0.489188717, 0.488329679, 0.487471974, 0.486615553, 0.485760367, 0.484906367, 0.484053504, 0.483201729, 0.482350994, 0.481501249, 0.480652444, 0.479804532, 0.478957463, 0.478111189, 0.477265659, 0.476420825, 0.475576639, 0.474733051, 0.473890012, 0.473047473, 0.472205385, 0.4713637, 0.470522368, 0.46968134, 0.468840567, 0.468, 0.467159599, 0.466319353, 0.465479264, 0.464639329, 0.463799549, 0.462959922, 0.462120447, 0.461281124, 0.460441952, 0.45960293, 0.458764057, 0.457925333, 0.457086756, 0.456248327, 0.455410044, 0.454571906, 0.453733913, 0.452896063, 0.452058357, 0.451220793, 0.45038337, 0.449546089, 0.448708947, 0.447871944, 0.447035079, 0.446198352, 0.445361762, 0.444525308, 0.443688989, 0.442852804, 0.442016753, 0.441180835, 0.440345049, 0.439509394, 0.43867387, 0.437838475, 0.437003209, 0.436168072, 0.435333061, 0.434498178, 0.43366342, 0.432828787, 0.431994278, 0.431159892, 0.430325629, 0.429491488, 0.428657468, 0.427823569, 0.426989788, 0.426156127, 0.425322583, 0.424489157, 0.423655846, 0.422822652, 0.421989572, 0.421156606, 0.420323753, 0.419491013, 0.418658384, 0.417825866, 0.416993458, 0.416161159, 0.415328969, 0.414496887, 0.413664911, 0.412833042, 0.412001278, 0.411169618, 0.410338062, 0.409506609, 0.408675258, 0.407844009, 0.40701286, 0.406181811, 0.405350862, 0.40452001, 0.403689256, 0.402858598, 0.402028037, 0.40119757, 0.400367198, 0.399536919, 0.398706733, 0.39787664, 0.397046637, 0.396216724, 0.395386902, 0.394557168, 0.393727522, 0.392897963, 0.392068491, 0.391239104, 0.390409803, 0.389580585, 0.388751451, 0.387922399, 0.387093429, 0.38626454, 0.385435732, 0.384607002, 0.383778351, 0.382949778, 0.382121282, 0.381292862, 0.380464518, 0.379636249, 0.378808053, 0.37797993, 0.37715188, 0.376323901, 0.375495993, 0.374668155, 0.373840386, 0.373012685, 0.372185052, 0.371357486, 0.370529986, 0.369702551, 0.368875181, 0.368047874, 0.36722063, 0.366393448, 0.365566328, 0.364739268, 0.363912267, 0.363085326, 0.362258443, 0.361431617, 0.360604848, 0.359778135, 0.358951476, 0.358124872, 0.357298322, 0.356471824, 0.355645378, 0.354818982, 0.353992638, 0.353166343, 0.352340096, 0.351513898, 0.350687746, 0.349861641, 0.349035582, 0.348209567, 0.347383597, 0.346557669, 0.345731784, 0.344905941, 0.344080139, 0.343254376, 0.342428653, 0.341602969, 0.340777322, 0.339951712, 0.339126139, 0.3383006, 0.337475097, 0.336649627, 0.33582419, 0.334998785, 0.334173412, 0.333348069, 0.332522757, 0.331697473, 0.330872218, 0.33004699, 0.329221789, 0.328396613, 0.327571463, 0.326746338, 0.325921236, 0.325096156, 0.324271099, 0.323446063, 0.322621048, 0.321796052, 0.320971075, 0.320146115, 0.319321174, 0.318496249, 0.317671339, 0.316846444, 0.316021564, 0.315196697, 0.314371843, 0.313547, 0.312722168, 0.311897347, 0.311072535, 0.310247731, 0.309422936, 0.308598147, 0.307773365, 0.306948588, 0.306123817, 0.305299048, 0.304474284, 0.303649521, 0.30282476, 0.302];


x_fit=[0.0,0.2,0.3,0.4,0.5,0.6,0.7,0.8,1.0];		% data to be interpolated
y_fit = [0.302,0.185,0.106,0.093,0.240,0.579,0.561,0.468,0.302];

figure
plot(x_fit,y_fit,'.','MarkerSize',15)
hold on
plot(x,u,"LineWidth",0.8)
legend("given data","Cubic spline")
grid minor