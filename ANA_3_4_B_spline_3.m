clear all
close all

X = [0.833333333, 0.842343167, 0.851372, 0.860418833, 0.869482667, 0.8785625, 0.887657333, 0.896766167, 0.905888, 0.915021833, 0.924166667, 0.9333215, 0.942485333, 0.951657167, 0.960836, 0.970020833, 0.979210667, 0.9884045, 0.997601333, 1.00680017, 1.016, 1.02519983, 1.03439867, 1.0435955, 1.05278933, 1.06197917, 1.071164, 1.08034283, 1.08951467, 1.0986785, 1.10783333, 1.11697817, 1.126112, 1.13523383, 1.14434267, 1.1534375, 1.16251733, 1.17158117, 1.180628, 1.18965683, 1.19866667, 1.2076565, 1.21662533, 1.22557217, 1.234496, 1.24339583, 1.25227067, 1.2611195, 1.26994133, 1.27873517, 1.2875, 1.29623483, 1.30493867, 1.3136105, 1.32224933, 1.33085417, 1.339424, 1.34795783, 1.35645467, 1.3649135, 1.37333333, 1.38171317, 1.390052, 1.39834883, 1.40660267, 1.4148125, 1.42297733, 1.43109617, 1.439168, 1.44719183, 1.45516667, 1.4630915, 1.47096533, 1.47878717, 1.486556, 1.49427083, 1.50193067, 1.5095345, 1.51708133, 1.52457017, 1.532, 1.53936983, 1.54667867, 1.5539255, 1.56110933, 1.56822917, 1.575284, 1.58227283, 1.58919467, 1.5960485, 1.60283333, 1.60954817, 1.616192, 1.62276383, 1.62926267, 1.6356875, 1.64203733, 1.64831117, 1.654508, 1.66062683, 1.66666667, 1.67262693, 1.6785088, 1.68431387, 1.69004373, 1.6957, 1.70128427, 1.70679813, 1.7122432, 1.71762107, 1.72293333, 1.7281816, 1.73336747, 1.73849253, 1.7435584, 1.74856667, 1.75351893, 1.7584168, 1.76326187, 1.76805573, 1.7728, 1.77749627, 1.78214613, 1.7867512, 1.79131307, 1.79583333, 1.8003136, 1.80475547, 1.80916053, 1.8135304, 1.81786667, 1.82217093, 1.8264448, 1.83068987, 1.83490773, 1.8391, 1.84326827, 1.84741413, 1.8515392, 1.85564507, 1.85973333, 1.8638056, 1.86786347, 1.87190853, 1.8759424, 1.87996667, 1.88398293, 1.8879928, 1.89199787, 1.89599973, 1.9, 1.90400027, 1.90800213, 1.9120072, 1.91601707, 1.92003333, 1.9240576, 1.92809147, 1.93213653, 1.9361944, 1.94026667, 1.94435493, 1.9484608, 1.95258587, 1.95673173, 1.9609, 1.96509227, 1.96931013, 1.9735552, 1.97782907, 1.98213333, 1.9864696, 1.99083947, 1.99524453, 1.9996864, 2.00416667, 2.00868693, 2.0132488, 2.01785387, 2.02250373, 2.0272, 2.03194427, 2.03673813, 2.0415832, 2.04648107, 2.05143333, 2.0564416, 2.06150747, 2.06663253, 2.0718184, 2.07706667, 2.08237893, 2.0877568, 2.09320187, 2.09871573, 2.1043, 2.10995627, 2.11568613, 2.1214912, 2.12737307, 2.13333333, 2.1393732, 2.14549227, 2.15168973, 2.1579648, 2.16431667, 2.17074453, 2.1772476, 2.18382507, 2.19047613, 2.1972, 2.20399587, 2.21086293, 2.2178004, 2.22480747, 2.23188333, 2.2390272, 2.24623827, 2.25351573, 2.2608588, 2.26826667, 2.27573853, 2.2832736, 2.29087107, 2.29853013, 2.30625, 2.31402987, 2.32186893, 2.3297664, 2.33772147, 2.34573333, 2.3538012, 2.36192427, 2.37010173, 2.3783328, 2.38661667, 2.39495253, 2.4033396, 2.41177707, 2.42026413, 2.4288, 2.43738387, 2.44601493, 2.4546924, 2.46341547, 2.47218333, 2.4809952, 2.48985027, 2.49874773, 2.5076868, 2.51666667, 2.52568653, 2.5347456, 2.54384307, 2.55297813, 2.56215, 2.57135787, 2.58060093, 2.5898784, 2.59918947, 2.60853333, 2.6179092, 2.62731627, 2.63675373, 2.6462208, 2.65571667, 2.66524053, 2.6747916, 2.68436907, 2.69397213, 2.7036, 2.71325187, 2.72292693, 2.7326244, 2.74234347, 2.75208333, 2.7618432, 2.77162227, 2.78141973, 2.7912348, 2.80106667, 2.81091453, 2.8207776, 2.83065507, 2.84054613, 2.85045, 2.86036587, 2.87029293, 2.8802304, 2.89017747, 2.90013333, 2.9100972, 2.92006827, 2.93004573, 2.9400288, 2.95001667, 2.96000853, 2.9700036, 2.98000107, 2.99000013, 3, 3.00999942, 3.01999533, 3.02998425, 3.03996267, 3.04992708, 3.059874, 3.06979992, 3.07970133, 3.08957475, 3.09941667, 3.10922358, 3.118992, 3.12871842, 3.13839933, 3.14803125, 3.15761067, 3.16713408, 3.176598, 3.18599892, 3.19533333, 3.20459775, 3.21378867, 3.22290258, 3.231936, 3.24088542, 3.24974733, 3.25851825, 3.26719467, 3.27577308, 3.28425, 3.29262192, 3.30088533, 3.30903675, 3.31707267, 3.32498958, 3.332784, 3.34045242, 3.34799133, 3.35539725, 3.36266667, 3.36979608, 3.376782, 3.38362092, 3.39030933, 3.39684375, 3.40322067, 3.40943658, 3.415488, 3.42137142, 3.42708333, 3.43262025, 3.43797867, 3.44315508, 3.448146, 3.45294792, 3.45755733, 3.46197075, 3.46618467, 3.47019558, 3.474, 3.47759442, 3.48097533, 3.48413925, 3.48708267, 3.48980208, 3.492294, 3.49455492, 3.49658133, 3.49836975, 3.49991667, 3.50121858, 3.502272, 3.50307342, 3.50361933, 3.50390625, 3.50393067, 3.50368908, 3.503178, 3.50239392, 3.50133333, 3.49999275, 3.49836867, 3.49645758, 3.494256, 3.49176042, 3.48896733, 3.48587325, 3.48247467, 3.47876808, 3.47475, 3.47041692, 3.46576533, 3.46079175, 3.45549267, 3.44986458, 3.443904, 3.43760742, 3.43097133, 3.42399225, 3.41666667, 3.40899242, 3.40097267, 3.39261192, 3.38391467, 3.37488542, 3.36552867, 3.35584892, 3.34585067, 3.33553842, 3.32491667, 3.31398992, 3.30276267, 3.29123942, 3.27942467, 3.26732292, 3.25493867, 3.24227642, 3.22934067, 3.21613592, 3.20266667, 3.18893742, 3.17495267, 3.16071692, 3.14623467, 3.13151042, 3.11654867, 3.10135392, 3.08593067, 3.07028342, 3.05441667, 3.03833492, 3.02204267, 3.00554442, 2.98884467, 2.97194792, 2.95485867, 2.93758142, 2.92012067, 2.90248092, 2.88466667, 2.86668242, 2.84853267, 2.83022192, 2.81175467, 2.79313542, 2.77436867, 2.75545892, 2.73641067, 2.71722842, 2.69791667, 2.67847992, 2.65892267, 2.63924942, 2.61946467, 2.59957292, 2.57957867, 2.55948642, 2.53930067, 2.51902592, 2.49866667, 2.47822742, 2.45771267, 2.43712692, 2.41647467, 2.39576042, 2.37498867, 2.35416392, 2.33329067, 2.31237342, 2.29141667, 2.27042492, 2.24940267, 2.22835442, 2.20728467, 2.18619792, 2.16509867, 2.14399142, 2.12288067, 2.10177092, 2.08066667, 2.05957242, 2.03849267, 2.01743192, 1.99639467, 1.97538542, 1.95440867, 1.93346892, 1.91257067, 1.89171842, 1.87091667, 1.85016992, 1.82948267, 1.80885942, 1.78830467, 1.76782292, 1.74741867, 1.72709642, 1.70686067, 1.68671592, 1.66666667];
Y = [2.01666667, 2.02311165, 2.02944653, 2.03567122, 2.0417856, 2.04778958, 2.05368307, 2.05946595, 2.06513813, 2.07069952, 2.07615, 2.08148948, 2.08671787, 2.09183505, 2.09684093, 2.10173542, 2.1065184, 2.11118978, 2.11574947, 2.12019735, 2.12453333, 2.12875732, 2.1328692, 2.13686888, 2.14075627, 2.14453125, 2.14819373, 2.15174362, 2.1551808, 2.15850518, 2.16171667, 2.16481515, 2.16780053, 2.17067272, 2.1734316, 2.17607708, 2.17860907, 2.18102745, 2.18333213, 2.18552302, 2.1876, 2.18956298, 2.19141187, 2.19314655, 2.19476693, 2.19627292, 2.1976644, 2.19894128, 2.20010347, 2.20115085, 2.20208333, 2.20290082, 2.2036032, 2.20419038, 2.20466227, 2.20501875, 2.20525973, 2.20538512, 2.2053948, 2.20528868, 2.20506667, 2.20472865, 2.20427453, 2.20370422, 2.2030176, 2.20221458, 2.20129507, 2.20025895, 2.19910613, 2.19783652, 2.19645, 2.19494648, 2.19332587, 2.19158805, 2.18973293, 2.18776042, 2.1856704, 2.18346278, 2.18113747, 2.17869435, 2.17613333, 2.17345432, 2.1706572, 2.16774188, 2.16470827, 2.16155625, 2.15828573, 2.15489662, 2.1513888, 2.14776218, 2.14401667, 2.14015215, 2.13616853, 2.13206572, 2.1278436, 2.12350208, 2.11904107, 2.11446045, 2.10976013, 2.10494002, 2.1, 2.09494018, 2.08976147, 2.08446495, 2.07905173, 2.07352292, 2.0678796, 2.06212288, 2.05625387, 2.05027365, 2.04418333, 2.03798402, 2.0316768, 2.02526278, 2.01874307, 2.01211875, 2.00539093, 1.99856072, 1.9916292, 1.98459748, 1.97746667, 1.97023785, 1.96291213, 1.95549062, 1.9479744, 1.94036458, 1.93266227, 1.92486855, 1.91698453, 1.90901132, 1.90095, 1.89280168, 1.88456747, 1.87624845, 1.86784573, 1.85936042, 1.8507936, 1.84214638, 1.83341987, 1.82461515, 1.81573333, 1.80677552, 1.7977428, 1.78863628, 1.77945707, 1.77020625, 1.76088493, 1.75149422, 1.7420352, 1.73250898, 1.72291667, 1.71325935, 1.70353813, 1.69375412, 1.6839084, 1.67400208, 1.66403627, 1.65401205, 1.64393053, 1.63379282, 1.6236, 1.61335318, 1.60305347, 1.59270195, 1.58229973, 1.57184792, 1.5613476, 1.55079988, 1.54020587, 1.52956665, 1.51888333, 1.50815702, 1.4973888, 1.48657978, 1.47573107, 1.46484375, 1.45391893, 1.44295772, 1.4319612, 1.42093048, 1.40986667, 1.39877085, 1.38764413, 1.37648762, 1.3653024, 1.35408958, 1.34285027, 1.33158555, 1.32029653, 1.30898432, 1.29765, 1.28629468, 1.27491947, 1.26352545, 1.25211373, 1.24068542, 1.2292416, 1.21778338, 1.20631187, 1.19482815, 1.18333333, 1.17182868, 1.16031613, 1.14879778, 1.13727573, 1.12575208, 1.11422893, 1.10270838, 1.09119253, 1.07968348, 1.06818333, 1.05669418, 1.04521813, 1.03375728, 1.02231373, 1.01088958, 0.999486933, 0.988107883, 0.976754533, 0.965428983, 0.954133333, 0.942869683, 0.931640133, 0.920446783, 0.909291733, 0.898177083, 0.887104933, 0.876077383, 0.865096533, 0.854164483, 0.843283333, 0.832455183, 0.821682133, 0.810966283, 0.800309733, 0.789714583, 0.779182933, 0.768716883, 0.758318533, 0.747989983, 0.737733333, 0.727550683, 0.717444133, 0.707415783, 0.697467733, 0.687602083, 0.677820933, 0.668126383, 0.658520533, 0.649005483, 0.639583333, 0.630256183, 0.621026133, 0.611895283, 0.602865733, 0.593939583, 0.585118933, 0.576405883, 0.567802533, 0.559310983, 0.550933333, 0.542671683, 0.534528133, 0.526504783, 0.518603733, 0.510827083, 0.503176933, 0.495655383, 0.488264533, 0.481006483, 0.473883333, 0.466897183, 0.460050133, 0.453344283, 0.446781733, 0.440364583, 0.434094933, 0.427974883, 0.422006533, 0.416191983, 0.410533333, 0.405032683, 0.399692133, 0.394513783, 0.389499733, 0.384652083, 0.379972933, 0.375464383, 0.371128533, 0.366967483, 0.362983333, 0.359178183, 0.355554133, 0.352113283, 0.348857733, 0.345789583, 0.342910933, 0.340223883, 0.337730533, 0.335432983, 0.333333333, 0.331433067, 0.3297312, 0.328226133, 0.326916267, 0.3258, 0.324875733, 0.324141867, 0.3235968, 0.323238933, 0.323066667, 0.3230784, 0.323272533, 0.323647467, 0.3242016, 0.324933333, 0.325841067, 0.3269232, 0.328178133, 0.329604267, 0.3312, 0.332963733, 0.334893867, 0.3369888, 0.339246933, 0.341666667, 0.3442464, 0.346984533, 0.349879467, 0.3529296, 0.356133333, 0.359489067, 0.3629952, 0.366650133, 0.370452267, 0.3744, 0.378491733, 0.382725867, 0.3871008, 0.391614933, 0.396266667, 0.4010544, 0.405976533, 0.411031467, 0.4162176, 0.421533333, 0.426977067, 0.4325472, 0.438242133, 0.444060267, 0.45, 0.456059733, 0.462237867, 0.4685328, 0.474942933, 0.481466667, 0.4881024, 0.494848533, 0.501703467, 0.5086656, 0.515733333, 0.522905067, 0.5301792, 0.537554133, 0.545028267, 0.5526, 0.560267733, 0.568029867, 0.5758848, 0.583830933, 0.591866667, 0.5999904, 0.608200533, 0.616495467, 0.6248736, 0.633333333, 0.641873067, 0.6504912, 0.659186133, 0.667956267, 0.6768, 0.685715733, 0.694701867, 0.7037568, 0.712878933, 0.722066667, 0.7313184, 0.740632533, 0.750007467, 0.7594416, 0.768933333, 0.778481067, 0.7880832, 0.797738133, 0.807444267, 0.8172, 0.827003733, 0.836853867, 0.8467488, 0.856686933, 0.866666667, 0.876686067, 0.886741867, 0.896830467, 0.906948267, 0.917091667, 0.927257067, 0.937440867, 0.947639467, 0.957849267, 0.968066667, 0.978288067, 0.988509867, 0.998728467, 1.00894027, 1.01914167, 1.02932907, 1.03949887, 1.04964747, 1.05977127, 1.06986667, 1.07993007, 1.08995787, 1.09994647, 1.10989227, 1.11979167, 1.12964107, 1.13943687, 1.14917547, 1.15885327, 1.16846667, 1.17801207, 1.18748587, 1.19688447, 1.20620427, 1.21544167, 1.22459307, 1.23365487, 1.24262347, 1.25149527, 1.26026667, 1.26893407, 1.27749387, 1.28594247, 1.29427627, 1.30249167, 1.31058507, 1.31855287, 1.32639147, 1.33409727, 1.34166667, 1.34909607, 1.35638187, 1.36352047, 1.37050827, 1.37734167, 1.38401707, 1.39053087, 1.39687947, 1.40305927, 1.40906667, 1.41489807, 1.42054987, 1.42601847, 1.43130027, 1.43639167, 1.44128907, 1.44598887, 1.45048747, 1.45478127, 1.45886667, 1.46274007, 1.46639787, 1.46983647, 1.47305227, 1.47604167, 1.47880107, 1.48132687, 1.48361547, 1.48566327, 1.48746667, 1.48902207, 1.49032587, 1.49137447, 1.49216427, 1.49269167, 1.49295307, 1.49294487, 1.49266347, 1.49210527, 1.49126667, 1.49014407, 1.48873387, 1.48703247, 1.48503627, 1.48274167, 1.48014507, 1.47724287, 1.47403147, 1.47050727, 1.46666667];

x_fit=[0.0,0.8,1.8,2.0,3.0,4.0,1.5,0.0];		% data to be interpolated
y_fit = [1.0,2.2,2.3,1.2,0.0,0.8,2.0,0.0];

figure
plot(x_fit,y_fit,'.','MarkerSize',13)
hold on
plot(X,Y,"LineWidth",0.8)
legend("given data","B-spline")
axis ([0 4 0 3])
grid minor