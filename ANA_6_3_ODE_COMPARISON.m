clear all
close all

x = [0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3, 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9, 4, 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9, 5];
y = -3*exp(-x) -2*x + 2;
y1 = [-1, -0.915, -0.857075, -0.823652875, -0.812405852, -0.821227296, -0.848210703, -0.891630686, -0.949925771, -1.02168282, -1.10562295, -1.20058877, -1.30553284, -1.41950722, -1.54165403, -1.6711969, -1.8074332, -1.94972704, -2.09750297, -2.25024019, -2.40746737, -2.56875797, -2.73372596, -2.902022, -3.07332991, -3.24736357, -3.42386403, -3.60259695, -3.78335024, -3.96593196, -4.15016843, -4.33590243, -4.5229917, -4.71130748, -4.90073327, -5.09116361, -5.28250307, -5.47466528, -5.66757208, -5.86115273, -6.05534322, -6.25008561, -6.44532748, -6.64102137, -6.83712434, -7.03359753, -7.23040576, -7.42751722, -7.62490308, -7.82253729, -8.02039624];
y2 = [-1, -0.915, -0.857075, -0.823652875, -0.812405852, -0.821227296, -0.848210703, -0.891630686, -0.949925771, -1.02168282, -1.10562295, -1.20058877, -1.30553284, -1.41950722, -1.54165403, -1.6711969, -1.8074332, -1.94972704, -2.09750297, -2.25024019, -2.40746737, -2.56875797, -2.73372596, -2.902022, -3.07332991, -3.24736357, -3.42386403, -3.60259695, -3.78335024, -3.96593196, -4.15016843, -4.33590243, -4.5229917, -4.71130748, -4.90073327, -5.09116361, -5.28250307, -5.47466528, -5.66757208, -5.86115273, -6.05534322, -6.25008561, -6.44532748, -6.64102137, -6.83712434, -7.03359753, -7.23040576, -7.42751722, -7.62490308, -7.82253729, -8.02039624];
y3 = [-1, -0.9145125, -0.856192704, -0.822455266, -0.810960867, -0.819592803, -0.846435803, -0.889756856, -0.947987869, -1.01970997, -1.10363932, -1.19861425, -1.30358362, -1.41759634, -1.53979183, -1.66939139, -1.80569043, -1.94805142, -2.09589747, -2.24870663, -2.40600659, -2.56736998, -2.73241014, -2.90077716, -3.07215445, -3.24625555, -3.42282126, -3.60161703, -3.78243065, -3.96507009, -4.14936161, -4.33514799, -4.52228697, -4.71064983, -4.90012012, -5.09059244, -5.28197143, -5.47417083, -5.66711255, -5.86072595, -6.05494712, -6.24971821, -6.4449869, -6.64070584, -6.83683217, -7.03332713, -7.23015563, -7.42728595, -7.62468935, -7.82233985, -8.02021393];
y4 = [-1, -0.914512251, -0.856192254, -0.822454655, -0.81096013, -0.81959197, -0.846434899, -0.889755901, -0.947986882, -1.01970897, -1.10363831, -1.19861324, -1.30358263, -1.41759537, -1.53979088, -1.66939047, -1.80568954, -1.94805056, -2.09589666, -2.24870585, -2.40600584, -2.56736928, -2.73240947, -2.90077652, -3.07215385, -3.24625499, -3.42282073, -3.60161653, -3.78243018, -3.96506966, -4.1493612, -4.3351476, -4.52228661, -4.7106495, -4.90011981, -5.09059215, -5.28197116, -5.47417058, -5.66711231, -5.86072573, -6.05494691, -6.24971802, -6.44498673, -6.64070568, -6.83683202, -7.03332699, -7.23015551, -7.42728583, -7.62468924, -7.82233975, -8.02021384];
y5 = [-1, -0.914512292, -0.856192327, -0.822454754, -0.810960249, -0.819592105, -0.846435045, -0.889756056, -0.947987042, -1.01970913, -1.10363848, -1.1986134, -1.30358279, -1.41759553, -1.53979104, -1.66939062, -1.80568969, -1.9480507, -2.09589679, -2.24870598, -2.40600596, -2.56736939, -2.73240958, -2.90077663, -3.07215395, -3.24625508, -3.42282081, -3.60161661, -3.78243026, -3.96506973, -4.14936127, -4.33514767, -4.52228667, -4.71064955, -4.90011986, -5.09059219, -5.28197121, -5.47417062, -5.66711235, -5.86072577, -6.05494695, -6.24971805, -6.44498676, -6.6407057, -6.83683204, -7.03332701, -7.23015553, -7.42728585, -7.62468926, -7.82233976, -8.02021385];


figure
plot(x,y,x,y1,x,y2,x,y3,x,y4,x,y5)
legend("exact solution","IMPROVED EULER'S METHOD","2ND ORDER RUNGE-KUTTA METHOD","4TH ORDER RUNGE-KUTTA METHOD","4TH ORDER RUNGE-KUTTA-FEHLBERG METHOD","4TH ORDER RUNGE-KUTTA-MERSON METHOD")
axis equal
grid minor

figure
plot(x,abs(y1-y),x,abs(y2-y),x,abs(y3-y),x,abs(y4-y),x,abs(y5-y))
title("Error for different methods")
legend("IMPROVED EULER'S METHOD","2ND ORDER RUNGE-KUTTA METHOD","4TH ORDER RUNGE-KUTTA METHOD","4TH ORDER RUNGE-KUTTA-FEHLBERG METHOD","4TH ORDER RUNGE-KUTTA-MERSON METHOD")
axis equal
grid minor